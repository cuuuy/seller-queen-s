<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1">

	<link rel="stylesheet" type="text/css" href="../css/jquery.bxslider.css">
	<link rel="stylesheet" type="text/css" href="../css/defalut.css">
	<link rel="stylesheet" type="text/css" href="../css/market_style.css">
	<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
	<script src="http://code.jquery.com/jquery-latest.min.js"></script>
	<script src="../js/jquery.bxslider.js"></script>
</head>
<body style="background:#ddd;">
	<div class="marketContainer">
		<div class="header">
			<header class="marketHeader">
			<div>
				<a href=""><img src="../image/market_back.png" alt=""></a>
			</div>
			<h2>주문내역</h2>
			<div class="marketHeader_mypage">
				<a href="javascript:void(0);" class="marketHeader_mypage_icon"><img src="../image/market_my.png" alt=""></a>
				<div class="marketHeader_mypage_menu">
					<p class="marketHeader_mypage_menu_close"><img src="../image/market_nav_arrow.png" alt=""></p>
					<div class="marketHeader_mypage_menu_top">
						<span class="marketHeader_mypage_menu_top_profile"></span>
						<h5>김셀럽 회원님, 환영합니다.</h5>
					</div>
					<ul class="marketHeader_mypage_menu_list">
						<li><a href="market_order.html">주문내역</a></li>
						<li><a href="market_cart.html">장바구니</a></li>
						<li><a href="market_review.html">후기 게시판</a></li>
						<li><a href="market_qna.html">문의 게시판</a></li>
						<li><a href="market_see.html">최근 본 상품</a></li>
					</ul>
					<ul class="marketHeader_mypage_menu_logout">
						<li>로그아웃</li>
					</ul>
				</div>
			</div>
		</header>
		</div>
		<div class="marketContent">
			<div class="marketOrder">
				<div>
					<h3>2022.10.07</h3>
					<ul class="marketOrder_list" id="marketOrder_list">
					</ul>
				</div>
			</div>
		</div>
	</div>
</body>


<script>
	$(function(){
		$('.marketHeader_mypage_icon').click(function(){
			$('.marketHeader_mypage_menu').animate({
				'right': '0'
			}, 300);
		});
		$('.marketHeader_mypage_menu_close').click(function(){
			$('.marketHeader_mypage_menu').animate({
				'right': '-300px'
			}, 300);
		});
	});
	
	$(document).ready(function(){
		order_load();
	});
	
	var user_id = localStorage.getItem('user_id')

	function order_load(){

		// ajax 통신
		$.ajax({
			type : "GET",            // HTTP method type(GET, POST) 형식이다.
			url : "http://43.200.169.89/orders_by_user?user_id="+user_id,      // 컨트롤러에서 대기중인 URL 주소이다.
			data : {
					
				},            // Json 형식의 데이터이다.
			success : function(res){ // 비동기통신의 성공일경우 success콜백으로 들어옵니다. 'res'는 응답받은 데이터이다.
				// 응답코드 > 0000
				console.log(res);
				
				for(var i = 0; i < res.length; i++){
					var new_html = `<li>
						<span class="marketOrder_list_thumb"></span>
						<div class="marketOrder_list_text">
							<p class="marketOrder_list_text01"><a href="market_order_detail.html?order_id=`+res[i].id+`">상품 정보</a></p>
							<p class="marketOrder_list_text02">TC 써지컬 하트 컬러 볼 팔찌</p>
							<p class="marketOrder_list_text03">
								<span class="marketOrder_list_text03_price">52,000원</span>
								<span>그린</span>
								<span>S</span>
							</p>
							<div class="marketOrder_list_text_btnbox">
								<button>-</button>
								<p>1</p>
								<button>+</button>
								<a href="">옵션 변경</a>
							</div>
						</div>
					</li>`;

					$("#marketOrder_list").append(new_html);

				}
				

				//if(res == "success"){
				//	alert("결제가 등록 되었습니다.");
				//	//location.href="market_sell_ok.html";
				//}else{
				//	alert("오류 발생. 관리자에게 문의하세요.");
				//}
			},
			error : function(XMLHttpRequest, textStatus, errorThrown){ // 비동기 통신이 실패할경우 error 콜백으로 들어옵니다.
				alert("통신 실패.")
			}
		});
	}
</script>
